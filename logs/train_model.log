__main__ - ERROR - 2021-12-02 09:58:00,032 - Failed to run script due to error:
[Errno 2] No such file or directory: 'data_wp_defecr.csv'
__main__ - ERROR - 2021-12-02 09:58:00,034 - Traceback (most recent call last):
  File "engine.py", line 128, in <module>
    running(args)
  File "engine.py", line 85, in running
    loader_train, loader_valid, loader_test = init_data_loader(args)
  File "engine.py", line 39, in init_data_loader
    df = pd.read_csv(args.data_csv)
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/pandas/io/parsers.py", line 610, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/pandas/io/parsers.py", line 462, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/pandas/io/parsers.py", line 819, in __init__
    self._engine = self._make_engine(self.engine)
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/pandas/io/parsers.py", line 1050, in _make_engine
    return mapping[engine](self.f, **self.options)  # type: ignore[call-arg]
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/pandas/io/parsers.py", line 1867, in __init__
    self._open_handles(src, kwds)
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/pandas/io/parsers.py", line 1368, in _open_handles
    storage_options=kwds.get("storage_options", None),
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/pandas/io/common.py", line 647, in get_handle
    newline="",
FileNotFoundError: [Errno 2] No such file or directory: 'data_wp_defecr.csv'

__main__ - ERROR - 2021-12-02 09:58:59,338 - Failed to run script due to error:
name 'train_test_split' is not defined
__main__ - ERROR - 2021-12-02 09:58:59,338 - Traceback (most recent call last):
  File "engine.py", line 128, in <module>
    running(args)
  File "engine.py", line 85, in running
    loader_train, loader_valid, loader_test = init_data_loader(args)
  File "engine.py", line 40, in init_data_loader
    train, val, test = split_data(df)
  File "engine.py", line 34, in split_data
    train, test = train_test_split(df, stratify=df.label, test_size=0.1, random_state=42)
NameError: name 'train_test_split' is not defined

__main__ - ERROR - 2021-12-02 10:00:12,445 - Failed to run script due to error:
name 'train_test_split' is not defined
__main__ - ERROR - 2021-12-02 10:00:12,446 - Traceback (most recent call last):
  File "engine.py", line 128, in <module>
    running(args)
  File "engine.py", line 85, in running
    loader_train, loader_valid, loader_test = init_data_loader(args)
  File "engine.py", line 40, in init_data_loader
    train, val, test = split_data(df)
  File "engine.py", line 34, in split_data
    train, test = train_test_split(df, stratify=df.label, test_size=0.1, random_state=42)
NameError: name 'train_test_split' is not defined

__main__ - ERROR - 2021-12-02 10:01:13,879 - Failed to run script due to error:
name 'DataLoader' is not defined
__main__ - ERROR - 2021-12-02 10:01:13,879 - Traceback (most recent call last):
  File "engine.py", line 129, in <module>
    running(args)
  File "engine.py", line 86, in running
    loader_train, loader_valid, loader_test = init_data_loader(args)
  File "engine.py", line 58, in init_data_loader
    loader_train = DataLoader(dataset = dataset_train, batch_size=args.batch_size, shuffle=True, num_workers=0)
NameError: name 'DataLoader' is not defined

__main__ - ERROR - 2021-12-02 10:02:26,063 - Failed to run script due to error:
name 'model' is not defined
__main__ - ERROR - 2021-12-02 10:02:26,064 - Traceback (most recent call last):
  File "engine.py", line 134, in <module>
    running(args)
  File "engine.py", line 93, in running
    artifacts = train_cnn(args, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 10, in train_cnn
    optimizer = torch.optim.Adamax(model.parameters(), lr=args.learning_rate)
NameError: name 'model' is not defined

__main__ - ERROR - 2021-12-02 10:05:07,469 - Failed to run script due to error:
too many values to unpack (expected 2)
__main__ - ERROR - 2021-12-02 10:05:07,470 - Traceback (most recent call last):
  File "engine.py", line 135, in <module>
    running(args)
  File "engine.py", line 94, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 15, in train_cnn
    for i, (images, labels) in enumerate(loader_train):
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 557, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/relationalai/mastec/debugging/DVC_wp/dataset.py", line 63, in __getitem__
    img_name, label = self.df[index]
ValueError: too many values to unpack (expected 2)

__main__ - ERROR - 2021-12-02 10:08:38,866 - Failed to run script due to error:
name 'os' is not defined
__main__ - ERROR - 2021-12-02 10:08:38,867 - Traceback (most recent call last):
  File "engine.py", line 135, in <module>
    running(args)
  File "engine.py", line 94, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 15, in train_cnn
    for i, (images, labels) in enumerate(loader_train):
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 557, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/relationalai/mastec/debugging/DVC_wp/dataset.py", line 64, in __getitem__
    img_path = os.path.join(self.data_dir, img_name)
NameError: name 'os' is not defined

__main__ - ERROR - 2021-12-02 10:09:21,969 - Failed to run script due to error:
name 'cv2' is not defined
__main__ - ERROR - 2021-12-02 10:09:21,970 - Traceback (most recent call last):
  File "engine.py", line 135, in <module>
    running(args)
  File "engine.py", line 94, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 15, in train_cnn
    for i, (images, labels) in enumerate(loader_train):
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 557, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/relationalai/mastec/debugging/DVC_wp/dataset.py", line 66, in __getitem__
    image = cv2.imread(img_path)
NameError: name 'cv2' is not defined

__main__ - ERROR - 2021-12-02 10:09:52,391 - Failed to run script due to error:
name 'np' is not defined
__main__ - ERROR - 2021-12-02 10:09:52,392 - Traceback (most recent call last):
  File "engine.py", line 135, in <module>
    running(args)
  File "engine.py", line 94, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 15, in train_cnn
    for i, (images, labels) in enumerate(loader_train):
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 557, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/relationalai/anaconda3/envs/m_rcnn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/relationalai/mastec/debugging/DVC_wp/dataset.py", line 69, in __getitem__
    image = self.transform(**{"image": np.array(image)})["image"]
NameError: name 'np' is not defined

__main__ - ERROR - 2021-12-02 10:10:47,484 - Failed to run script due to error:
name 'mlflow' is not defined
__main__ - ERROR - 2021-12-02 10:10:47,485 - Traceback (most recent call last):
  File "engine.py", line 135, in <module>
    running(args)
  File "engine.py", line 94, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 43, in train_cnn
    mlflow.log_metrics(
NameError: name 'mlflow' is not defined

__main__ - ERROR - 2021-12-02 10:11:32,143 - Failed to run script due to error:
name 'args' is not defined
__main__ - ERROR - 2021-12-02 10:11:32,143 - Traceback (most recent call last):
  File "engine.py", line 135, in <module>
    running(args)
  File "engine.py", line 94, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 51, in train_cnn
    performance = test(best_model, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/test.py", line 22, in test
    x = x.to(args.device)
NameError: name 'args' is not defined

__main__ - ERROR - 2021-12-02 10:12:45,453 - Failed to run script due to error:
'types.SimpleNamespace' object has no attribute 'eval'
__main__ - ERROR - 2021-12-02 10:12:45,454 - Traceback (most recent call last):
  File "engine.py", line 135, in <module>
    running(args)
  File "engine.py", line 94, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 51, in train_cnn
    performance = test(best_model, args, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/test.py", line 16, in test
    model.eval()
AttributeError: 'types.SimpleNamespace' object has no attribute 'eval'

__main__ - ERROR - 2021-12-02 10:16:17,431 - Failed to run script due to error:
name 'precision_recall_fscore_support' is not defined
__main__ - ERROR - 2021-12-02 10:16:17,431 - Traceback (most recent call last):
  File "engine.py", line 131, in <module>
    running(args)
  File "engine.py", line 89, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/train.py", line 51, in train_cnn
    performance = test(args, best_model, loader_test)
  File "/home/relationalai/mastec/debugging/DVC_wp/test.py", line 35, in test
    metrics = precision_recall_fscore_support(sub['target'], sub['pred'], average="weighted")
NameError: name 'precision_recall_fscore_support' is not defined

numexpr.utils - INFO - 2021-12-02 10:54:44,956 - NumExpr defaulting to 6 threads.
numexpr.utils - INFO - 2021-12-02 10:55:00,806 - NumExpr defaulting to 6 threads.
numexpr.utils - INFO - 2021-12-02 10:57:25,352 - NumExpr defaulting to 6 threads.
numexpr.utils - INFO - 2021-12-02 13:20:18,363 - NumExpr defaulting to 6 threads.
__main__ - ERROR - 2021-12-03 17:11:01,033 - Failed to run script due to error:
You are trying to use a deprecated augmentation 'IAAAdditiveGaussianNoise' which depends on the imgaug library, but imgaug is not installed.

There are two options to fix this error:
1. [Recommended]. Switch to the Albumentations' implementation of the augmentation with the same API: GaussNoise - https://albumentations.ai/docs/api_reference/augmentations/transforms/#albumentations.augmentations.transforms.GaussNoise
2. Install a version of Albumentations that contains imgaug by running 'pip install -U albumentations[imgaug]'.
__main__ - ERROR - 2021-12-03 17:11:01,034 - Traceback (most recent call last):
  File "src/engine.py", line 171, in <module>
    running(args)
  File "src/engine.py", line 123, in running
    loader_train, loader_valid, loader_test, tags = init_data_loader(args)
  File "src/engine.py", line 70, in init_data_loader
    train_tfms, test_tfms = get_augmentations(p=0.5)
  File "/Users/haythemtellili/github_projects/Image_classification_with_MLflow/src/dataset.py", line 32, in get_augmentations
    A.OneOf([A.IAAAdditiveGaussianNoise(), A.GaussNoise(),], p=p),
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/albumentations/imgaug/stubs.py", line 19, in __init__
    raise RuntimeError(
RuntimeError: You are trying to use a deprecated augmentation 'IAAAdditiveGaussianNoise' which depends on the imgaug library, but imgaug is not installed.

There are two options to fix this error:
1. [Recommended]. Switch to the Albumentations' implementation of the augmentation with the same API: GaussNoise - https://albumentations.ai/docs/api_reference/augmentations/transforms/#albumentations.augmentations.transforms.GaussNoise
2. Install a version of Albumentations that contains imgaug by running 'pip install -U albumentations[imgaug]'.

__main__ - ERROR - 2021-12-03 17:17:56,770 - Failed to run script due to error:
Torch not compiled with CUDA enabled
__main__ - ERROR - 2021-12-03 17:17:56,771 - Traceback (most recent call last):
  File "src/engine.py", line 171, in <module>
    running(args)
  File "src/engine.py", line 125, in running
    model = SimpleCNN(args.num_classes).to(args.device)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 673, in to
    return self._apply(convert)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 387, in _apply
    module._apply(fn)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 409, in _apply
    param_applied = fn(param)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 671, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/torch/cuda/__init__.py", line 164, in _lazy_init
    raise AssertionError("Torch not compiled with CUDA enabled")
AssertionError: Torch not compiled with CUDA enabled

__main__ - ERROR - 2021-12-03 18:36:22,515 - Failed to run script due to error:
name 'best_model' is not defined
__main__ - ERROR - 2021-12-03 18:36:22,516 - Traceback (most recent call last):
  File "src/engine.py", line 171, in <module>
    running(args)
  File "src/engine.py", line 127, in running
    artifacts = train_cnn(args, model, loader_train, loader_valid, loader_test)
  File "/Users/haythemtellili/github_projects/Image_classification_with_MLflow/src/train.py", line 56, in train_cnn
    performance = test(args, best_model, loader_test)
  File "/Users/haythemtellili/github_projects/Image_classification_with_MLflow/src/test.py", line 21, in test
    output = best_model(x)
NameError: name 'best_model' is not defined

__main__ - ERROR - 2021-12-03 18:38:36,665 - Failed to run script due to error:
[Errno 45] Operation not supported: '/home/relationalai'
__main__ - ERROR - 2021-12-03 18:38:36,672 - Traceback (most recent call last):
  File "src/engine.py", line 171, in <module>
    running(args)
  File "src/engine.py", line 140, in running
    mlflow.log_artifacts(dp)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 277, in log_artifacts
    MlflowClient().log_artifacts(run_id, local_dir, artifact_path)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/mlflow/tracking/client.py", line 254, in log_artifacts
    artifact_repo.log_artifacts(local_dir, artifact_path)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/mlflow/store/local_artifact_repo.py", line 43, in log_artifacts
    mkdir(artifact_dir)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 106, in mkdir
    raise e
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 103, in mkdir
    os.makedirs(target)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  [Previous line repeated 4 more times]
  File "/usr/local/anaconda3/envs/mlflow_test/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
OSError: [Errno 45] Operation not supported: '/home/relationalai'

